<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="UTF-8"/>
    <title>8.3.2.2 Vérification de NetFlow</title>
    <!-- Content -->
    <link type="text/css" rel="stylesheet" href="../../common/styles/course.css"/>
    <script type="text/javascript" src="../../common/scripts/jquery_bundle.min.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/page.js"></script>
    <script>
      var myLayout;
      $(document).ready(function () {
        var frame = document.getElementById('mainFrame');
        if (isTextOnly(window)) {
          frame.setAttribute('src', 'media_8.3.2.2_longdesc.txt');
        } else {
          frame.setAttribute('src', 'media/index.html');
        }
        myLayout = $('body').layout({
          west__size: 300,
          west__minSize: 300,
          center__minWidth: 100,
          resizerTip: 'Redimensionner',
          sliderTip: 'Ouvrir par glissement',
          togglerTip_open: 'Fermer',
          togglerTip_closed: 'Ouvrir',
          stateManagement__enabled: true,
          maskIframesOnResize: true,
          livePaneResizing: true,
          onresize_end: resizeTextDiv,
          stateManagement__cookie__name: "ui_pane",
          stateManagement__cookie__expires: 1,
          stateManagement__cookie__path: "/"
        });
        var isiPad = navigator.userAgent.match(/iPad/i) != null;
        if(isiPad){
          var paneOptions = myLayout.options["west"]; 
          paneOptions.spacing_open = 12;
          myLayout.resizeAll(); 
        }
      });
      function resizeTextDiv() {
        var DivHeight = document.getElementById("header").offsetHeight;
        document.getElementById("content").style.top = String(DivHeight) + 'px';
      }
    </script>
  </head>
  <body class="onecolumn" onLoad="resizeTextDiv()">
    <div class="ui-layout-west">
      <div id="header">
        <h1>NetFlow</h1>
        <h2>Configuration de NetFlow</h2>
      </div>
      <div id="content">
<p>Après la vérification du fonctionnement correct de NetFlow, la collecte de données peut commencer sur le collecteur NetFlow. La vérification de Netflow s'effectue par l'examen des informations stockées dans le collecteur NetFlow. Au minimum, contrôlez le cache local de NetFlow sur un routeur afin de vous assurer que le routeur collecte les données. </p>
<p></p>
<p>NetFlow a été configuré comme suit sur le routeur R1 :</p>
<p>
<ul>
<li>Adresse IP 192.168.1.1/24 sur G0/1</li>
</ul>
</p>
<p>
<ul>
<li>Trafic d'entrée et de sortie surveillé par NetFlow</li>
</ul>
</p>
<p>
<ul>
<li>Collecteur NetFlow à l'adresse 192.168.1.3/24</li>
</ul>
</p>
<p>
<ul>
<li>Port de capture UDP NetFlow 2055</li>
</ul>
</p>
<p>
<ul>
<li>Format d'exportation de la version 5 de NetFlow </li>
</ul>
</p>
<p></p>
<p>Pour afficher un résumé des statistiques de gestion des comptes NetFlow, ainsi que le protocole utilisant le plus grand volume du trafic, et voir entre quels hôtes ce trafic s'écoule, utilisez la commande <span class="cmd"><b>show ip cache flow</b></span> en mode d'exécution utilisateur ou en mode d'exécution privilégié. Cette commande est exécutée sur R1 afin de vérifier la configuration de NetFlow, comme le montre la Figure 1. Le résultat de la commande indique quel protocole utilise le plus grand volume du trafic ainsi que les hôtes entre lesquels ce trafic s'écoule. Le tableau de la Figure 1 décrit les champs significatifs des lignes de cache de commutation de flux du résultat de la commande.</p>
<p></p>
<p>Le résultat affiché en haut de l'écran confirme que le routeur collecte des données. La première entrée en surbrillance indique un nombre de paquets contrôlés par NetFlow égal à 178.617. La fin du résultat montre des statistiques relatives à trois flux, le flux en surbrillance correspondant à une connexion HTTPS active entre le collecteur NetFlow et R1. Elle indique également le port source (SrcP) et le port de destination (DstP) au format hexadécimal. </p>
<p></p>
<p>
<b>Remarque</b> : le nombre hexadécimal 01BB est égal au nombre décimal 443, qui correspond au port TCP réservé à HTTPS. </p>
<p></p>
<p>La Figure 2 décrit les champs significatifs des lignes de cache de commutation de flux du résultat de la commande <span class="cmd"><b>show ip cache flow</b></span>.</p>
<p></p>
<p>La Figure 3 décrit les champs significatifs des lignes d'activité par protocole du résultat de la commande <span class="cmd"><b>show ip cache flow</b></span>.</p>
<p></p>
<p>La Figure 4 décrit les champs significatifs des lignes d'enregistrement NetFlow du résultat de la commande <span class="cmd"><b>show ip cache flow</b></span>.</p>
<p></p>
<p>Bien que le résultat de la commande <span class="cmd"><b>show ip cache flow</b></span> confirme que le routeur collecte des données, utilisez la commande <span class="cmd"><b>show ip flow interface</b></span>, comme le montre la Figure 5, afin de vous assurer que NetFlow est configuré sur les interfaces correctes et dans les directions appropriées. </p>
<p></p>
<p>Pour contrôler la configuration des paramètres d'exportation, utilisez la commande <span class="cmd"><b>show ip flow export</b></span>, comme le montre la Figure 5. La première ligne en surbrillance indique que le protocole NetFlow est activé avec le format d'exportation de la version 5. Les dernières lignes en surbrillance de la Figure 5 montrent que 1764 flux ont été exportés sous la forme de 532 datagrammes UDP vers le collecteur NetFlow à l'adresse 192.168.1.3 par le biais du port 2055.</p>
<p></p>
<p>Utilisez le contrôleur de syntaxe indiqué à la Figure 6 pour configurer et vérifier le protocole NetFlow sur R1.</p>
</div>
    </div>
    <iframe id="mainFrame" name="mainFrame" frameborder="0" class="ui-layout-center" alt="interactive graphic"></iframe>
  </body>
</html>
